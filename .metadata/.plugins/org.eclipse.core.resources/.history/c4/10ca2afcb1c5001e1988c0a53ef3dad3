package book.my.car.service.impl;

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.BeanUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import book.my.car.entity.CarDetails;
import book.my.car.exception.ResourceNotFoundException;
import book.my.car.repo.CarRepository;
import book.my.car.request.CarRequest;
import book.my.car.response.CarResponse;
import book.my.car.service.CarService;

@Service
public class CarServiceImpl implements CarService{

	@Autowired
	private CarRepository carRepository;
	
	@Override
	public CarResponse saveCar(CarRequest carRequest) {
		
		CarResponse carResponse=new CarResponse();
		
		BeanUtils.copyProperties(carRequest, carResponse);
		
		CarDetails carDetails=new CarDetails();
		
		BeanUtils.copyProperties(carRequest, carDetails);
		
		carRepository.save(carDetails);
		
		
		return carResponse;
	}

	@Override
	public List<CarResponse> getAllCars() {
		
		List<CarDetails> carList = carRepository.findAll();
		
		List<CarResponse> carResponses=new ArrayList<>();
		
		for(CarDetails carDetails : carList) {
			
			CarResponse carResponse=new CarResponse();
			
			BeanUtils.copyProperties(carDetails, carResponse);
			
			carResponses.add(carResponse);
		}
		
		return carResponses;
	}

	@Override
	public CarResponse getCarByCarId(String carId) {
		
		CarDetails carDetails = carRepository.findById(carId).orElseThrow(()-> new ResourceNotFoundException("Car", "CarId", carId));
		
		CarResponse cResponse=new CarResponse();
		
		BeanUtils.copyProperties(carDetails, cResponse);
		return cResponse;
	}

}
